<form data-request="onAddToCart"
      data-request-success="data.added && $.publish('mall.cart.productAdded', data)"
      data-request-validate
      data-request-flash
      class="mall-add-to-cart"
      id="mall-add-to-cart-horizontal-{{ horizontalId }}">
    
    <div class="row">
        <div class="col-6 left-panel">
            {% if variants.count > 0 %}
                <h5 class="mall-product__variants-heading">{{ 'offline.mall::frontend.variants' | trans }}</h5>
                <div class="mall-product__variants">
                    {% for value, variant in variants %}
                        {% set variant = variant.first() %}
                        <div class="mall-product__variant">
                            <a href="{{ this.page.fileName|page({slug: this.param.slug, variant: variant.hashId}) }}"
                            title="{{ variant.name }}">
                                <img src="{{ variant.main_image.thumb(80, auto) }}" alt="{{ variant.name }}"/>
                            </a>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}

            {% if props.count > 0 and item.inventory_management_method == 'variant' %}
                <div class="mall-product__variant-properties">
                    {% partial __SELF__ ~ '::properties' props=props %}
                </div>
            {% endif %}

            {% if item.custom_fields.count > 0 %}
                <div class="mall-product__custom-fields">
                    {% partial __SELF__ ~ '::customfields' fields=item.custom_fields %}
                </div>
            {% endif %}

            <div class="mall-product__price">
                {% partial __SELF__ ~ '::price' item=item %}
            </div>

            <div class="mall-product__tax-info">
                {% partial __SELF__ ~ '::tax-info' item=item %}
            </div>
            {% if not item.allow_out_of_stock_purchases %}
                {% if stock is defined %}                
                    <div class="mall-product__property-stock 
                        text-{{ stock > 10 ? 'success' : 'danger' }}
                        {{ stock <= 10 and stock > 0 ? 'font-weight-bold' }}"
                    >

                        {% if stock > 10 %}
                            {{ 'offline.mall::frontend.stock.many_available' | trans }}
                        {% elseif stock > 0 %}
                            <i class="fas fa-exclamation-triangle"></i>
                            {{ 'offline.mall::frontend.stock.available' | transchoice(stock, {stock: stock}) }}
                        {% else %}
                            {{ 'offline.mall::frontend.stock.unavailable' | trans }}
                        {% endif %}
                    </div>
                {% else %}
                    <div class="mall-product__property-stock mall-product__property-stock--checking">
                        {{ 'offline.mall::frontend.stock.checking' | trans }}
                    </div>
                {% endif %}
            {% endif %}
        </div>
        <div class="col-6 right-panel">
            <div class="mall-product__add-to-cart">
                {% if item.allow_out_of_stock_purchases %}
                    {% partial __SELF__ ~ '::addtocart.htm' item=item %}
                {% else %}
                    <div class="mall-product__property-stock mall-product__property-stock--checking">
                        {{ 'offline.mall::frontend.stock.checking' | trans }}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</form>